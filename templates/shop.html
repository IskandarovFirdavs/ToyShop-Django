{% extends 'layouts/base.html' %}
<!--  -->
{% load static %}
<!--  -->
{% load mytags %}
<!--  -->
{% block title %}Shop{% endblock %}
<!--  -->
{% block extra_css %}
<!--  -->
<style>
  /* Responsive styles directly in the template */
  .shop-layout {
    display: flex;
    flex-direction: row;
    gap: 30px;
  }

  .shop-sidebar {
    width: 250px;
  }

  .shop-products {
    flex: 1;
  }

  .product-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 30px;
  }

  .mobile-filter-toggle {
    display: none;
  }

  @media (max-width: 992px) {
    .shop-layout {
      flex-direction: column;
    }

    .shop-sidebar {
      width: 100%;
    }

    .mobile-filter-toggle {
      display: block;
      margin-bottom: 15px;
    }

    .filter-content {
      display: none;
    }

    .filter-content.active {
      display: block;
    }

    .product-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (max-width: 576px) {
    .product-grid {
      grid-template-columns: 1fr;
    }

    .shop-header {
      flex-direction: column;
      align-items: flex-start;
      gap: 15px;
    }
  }
</style>
{% endblock %} {% block content %}
<!-- Shop Header -->
<section class="hero" style="padding: 50px 0">
  <div class="container">
    <h1 class="hero-title">Our Toy Collection</h1>
    <p class="hero-subtitle">Browse our wide selection of toys for all ages</p>
  </div>
</section>

<!-- Shop Content -->
<section class="section">
  <div class="container">
    <div class="shop-layout">
      <!-- Sidebar Filters -->
      <div class="shop-sidebar">
        <!-- Mobile Filter Toggle Button -->
        <button
          class="btn btn-outline mobile-filter-toggle"
          onclick="toggleFilters()"
          style="width: 100%"
        >
          <i class="fas fa-filter"></i> Show Filters
        </button>

        <div class="filter-content" id="filterContent">
          <div class="filter-section" style="margin-bottom: 30px">
            <h3 style="margin-bottom: 15px">Categories</h3>
            {% for category in categories %}
            <li style="margin-bottom: 10px">
              <label
                style="display: flex; align-items: center; cursor: pointer"
              >
                <input type="checkbox" style="margin-right: 10px" />
                {{ category.name }}
              </label>
            </li>
            {% endfor %}
          </div>

          <div class="filter-section" style="margin-bottom: 30px">
            <h3 style="margin-bottom: 15px">Age Range</h3>
            <ul style="list-style: none; padding: 0">
              <li style="margin-bottom: 10px">
                <label
                  style="display: flex; align-items: center; cursor: pointer"
                >
                  <input type="checkbox" style="margin-right: 10px" />
                  0-2 Years
                </label>
              </li>
              <li style="margin-bottom: 10px">
                <label
                  style="display: flex; align-items: center; cursor: pointer"
                >
                  <input type="checkbox" style="margin-right: 10px" />
                  3-5 Years
                </label>
              </li>
              <li style="margin-bottom: 10px">
                <label
                  style="display: flex; align-items: center; cursor: pointer"
                >
                  <input type="checkbox" style="margin-right: 10px" />
                  6-8 Years
                </label>
              </li>
              <li style="margin-bottom: 10px">
                <label
                  style="display: flex; align-items: center; cursor: pointer"
                >
                  <input type="checkbox" style="margin-right: 10px" />
                  9-12 Years
                </label>
              </li>
              <li style="margin-bottom: 10px">
                <label
                  style="display: flex; align-items: center; cursor: pointer"
                >
                  <input type="checkbox" style="margin-right: 10px" />
                  12+ Years
                </label>
              </li>
            </ul>
          </div>

          <div class="filter-section" style="margin-bottom: 30px">
            <h3 style="margin-bottom: 15px">Price Range</h3>
            <div style="padding: 0 10px">
              <input
                type="range"
                min="0"
                max="100"
                value="50"
                style="width: 100%; margin-bottom: 10px"
              />
              <div style="display: flex; justify-content: space-between">
                <span>$0</span>
                <span>$100</span>
              </div>
            </div>
          </div>

          <button class="btn btn-primary" style="width: 100%">
            Apply Filters
          </button>
        </div>
      </div>

      <!-- Product Grid -->
      <div class="shop-products">
        <div
          class="shop-header"
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
          "
        >
          <div>
            <p>Showing {{products.count}} of {{products.all.count}} products</p>
          </div>
          <div style="display: flex; align-items: center">
            <label style="margin-right: 10px">Sort by:</label>
            <select class="form-control" style="width: auto">
              <option>Featured</option>
              <option>Price: Low to High</option>
              <option>Price: High to Low</option>
              <option>Newest</option>
              <option>Best Selling</option>
            </select>
          </div>
        </div>

        <div class="product-grid">
          {% for product in products %}
          <div class="card">
            <img
              src="{{ product.image.url }}"
              alt="{{ product.name }}"
              class="card-img"
            />
            <div class="card-body">
              <h3 class="card-title">{{product.name}}</h3>
              <p class="card-text">{{product.short_description}}</p>
              <div class="card-price">
                {{ product.get_price }} UZS    
                {% if product.is_discounted %}
                    | <strong><strike>{{ product.price }} UZS</strike></strong>
                {% endif %}
            </div>
            

              <!-- Replaced buttons with the unordered list -->              <ul class="list-unstyled">
                <a
                  class="btn btn-success text-white"
                  href="{% url 'products:wishlist-create' pk=product.pk %}?next={{ request.path }}?{{ request.GET.urlencode }}"
                >
                  <i class="{% get_heart_icon request product %}"></i>
                </a>
                <a
                  class="btn btn-success text-white mt-2"
                  href="{% url 'products:product' pk=product.pk %}"
                >
                  <i class="far fa-eye"></i>
                </a>
                <a
                  class="btn btn-success text-white mt-2"
                  href="{% url 'products:cart-create' pk=product.pk %}?next={{ request.path }}?{{ request.GET.urlencode }}"
                >
                  <i class="fas fa-cart-plus"></i>
                </a>
            </div>
          </div>
          {% endfor %}
        </div>

        <!-- Pagination -->
        <div style="display: flex; justify-content: center; margin-top: 40px">
          <div
            class="pagination"
            style="display: flex; gap: 5px; flex-wrap: wrap"
          >
            <a
              href="#"
              style="
                width: 40px;
                height: 40px;
                display: flex;
                align-items: center;
                justify-content: center;
                border-radius: 5px;
                border: 1px solid var(--border-color);
                text-decoration: none;
                color: var(--text-color);
              "
            >
              <i class="fas fa-chevron-left"></i>
            </a>
            <a
              href="#"
              style="
                width: 40px;
                height: 40px;
                display: flex;
                align-items: center;
                justify-content: center;
                border-radius: 5px;
                border: 1px solid var(--border-color);
                text-decoration: none;
                color: white;
                background-color: var(--primary-color);
              "
              >1</a
            >
            <a
              href="#"
              style="
                width: 40px;
                height: 40px;
                display: flex;
                align-items: center;
                justify-content: center;
                border-radius: 5px;
                border: 1px solid var(--border-color);
                text-decoration: none;
                color: var(--text-color);
              "
              >2</a
            >
            <a
              href="#"
              style="
                width: 40px;
                height: 40px;
                display: flex;
                align-items: center;
                justify-content: center;
                border-radius: 5px;
                border: 1px solid var(--border-color);
                text-decoration: none;
                color: var(--text-color);
              "
              >3</a
            >
            <a
              href="#"
              style="
                width: 40px;
                height: 40px;
                display: flex;
                align-items: center;
                justify-content: center;
                border-radius: 5px;
                border: 1px solid var(--border-color);
                text-decoration: none;
                color: var(--text-color);
              "
            >
              <i class="fas fa-chevron-right"></i>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
{% endblock %} {% block extra_js %}
<script>
  // Simple filter toggle function
  function toggleFilters() {
    var filterContent = document.getElementById("filterContent");
    var toggleButton = document.querySelector(".mobile-filter-toggle");

    if (filterContent.classList.contains("active")) {
      filterContent.classList.remove("active");
      toggleButton.innerHTML = '<i class="fas fa-filter"></i> Show Filters';
    } else {
      filterContent.classList.add("active");
      toggleButton.innerHTML = '<i class="fas fa-times"></i> Hide Filters';
    }
  }

  // On page load, make filter content active for desktop view
  document.addEventListener("DOMContentLoaded", function () {
    var filterContent = document.getElementById("filterContent");
    if (window.innerWidth > 992) {
      filterContent.classList.add("active");
    }

    // Add window resize listener to handle filter visibility
    window.addEventListener("resize", function () {
      if (window.innerWidth > 992) {
        filterContent.classList.add("active");
      } else if (!filterContent.classList.contains("user-toggled")) {
        filterContent.classList.remove("active");
      }
    });

    // Load navbar and footer
    fetch("navbar.html")
      .then((response) => response.text())
      .then((data) => {
        const parser = new DOMParser();
        const navbarDoc = parser.parseFromString(data, "text/html");
        const navbarContent = navbarDoc.querySelector(".navbar");
        document
          .getElementById("navbar-placeholder")
          .appendChild(navbarContent);

        // Execute navbar scripts
        const scripts = navbarDoc.querySelectorAll("script");
        scripts.forEach((script) => {
          const newScript = document.createElement("script");
          if (script.src) {
            newScript.src = script.src;
          } else {
            newScript.textContent = script.textContent;
          }
          document.body.appendChild(newScript);
        });
      });

    fetch("footer.html")
      .then((response) => response.text())
      .then((data) => {
        const parser = new DOMParser();
        const footerDoc = parser.parseFromString(data, "text/html");
        const footerContent = footerDoc.querySelector(".footer");
        document
          .getElementById("footer-placeholder")
          .appendChild(footerContent);
      });
  });
</script>
{% endblock %}
